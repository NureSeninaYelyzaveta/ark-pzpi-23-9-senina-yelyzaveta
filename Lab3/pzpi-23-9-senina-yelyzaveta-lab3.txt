 Міністерство освіти і науки України
 Харківський національний університет радіоелектроніки 
Кафедра програмної інженерії 









Лабораторна робота №3
 з дисципліни: «Аналіз та рефакторінг коду»
 на тему: «РОЗРОБКА БІЗНЕС-ЛОГІКИ ТА ФУНКЦІЙ АДМІНІСТРУВАННЯ СЕРВЕРНОЇ ЧАСТИНИ ПРОГРАМНОЇ СИСТЕМИ »








Виконала: ст. гр. ПЗПІ-23-9
Сеніна Єлизавета Андріївна

Перевірив: Дашенков Дмитро Сергійович





 Харків 2025
	Розділ 1. Бізнес-логіка серверної частини програмної системи
	Бізнес-логіка серверної частини програмної системи для контролю успішності учнів художніх шкіл формується на основі вимог, визначених у документах Vision and Scope, і відображає функціональність початкового релізу. Серверна частина виступає центральним ядром, яке забезпечує обробку даних, узгоджену взаємодію між користувачами та підтримку ключових процесів освітнього середовища.
	Основою бізнес-логіки є ведення бази даних користувачів, що охоплює учнів, викладачів та адміністрацію. Для кожної категорії визначено набір атрибутів, які зберігаються у реляційній базі даних MySQL. Серверна частина реалізує механізми створення, редагування та видалення записів, контролює унікальність ідентифікаторів та забезпечує цілісність зв’язків між таблицями. Це дозволяє підтримувати актуальність інформації та гарантувати коректність її використання у подальших процесах.
	Важливим елементом є облік оцінок і навчальних результатів. Викладачі мають можливість вносити оцінки за предметами та творчими дисциплінами, додавати коментарі до робіт, а серверна частина автоматично обробляє ці дані. Бізнес-логіка реалізує алгоритми розрахунку середніх показників, формування рейтингів та узагальнених таблиць, що дозволяє адміністрації отримувати достовірну інформацію для аналізу успішності та прийняття управлінських рішень.
	Система сповіщень функціонує як окремий підсервіс, який реагує на події, пов’язані зі змінами у навчальних результатах. Серверна частина генерує повідомлення про нові оцінки, коментарі чи інші важливі події та надсилає їх учням і батькам у режимі реального часу. Це забезпечує прозорість освітнього процесу та своєчасну комунікацію між усіма сторонами.
	Формування статистичних звітів є ще одним ключовим компонентом бізнес-логіки. Серверна частина агрегує дані за класами, групами та навчальними періодами, створюючи узагальнені звіти для адміністрації школи. Алгоритми обробки забезпечують представлення інформації у табличній та графічній формах, що дозволяє оцінювати ефективність викладання, планувати навантаження та приймати обґрунтовані управлінські рішення.
	Уся взаємодія між клієнтськими застосунками та сервером здійснюється через прикладний програмний інтерфейс REST API. Це забезпечує узгоджений обмін даними, стабільність роботи та кросплатформенність системи. Веб-клієнт орієнтований на викладачів та адміністрацію, мобільний клієнт призначений для учнів і батьків, а серверна частина виступає єдиним джерелом даних, що гарантує їхню актуальність і цілісність.
	Таким чином, бізнес-логіка серверної частини у початковому релізі реалізує повний цикл обробки навчальних даних: управління користувачами, облік оцінок, автоматичні сповіщення та формування статистичних звітів. Це створює основу для подальшого розширення функціональності, зокрема впровадження модулів розширеної аналітики та інтеграції з зовнішніми освітніми сервісами, що було визначено у попередніх роботах як перспективний напрям розвитку системи.

	Розділ 2. Функції адміністрування серверної частини програмної системи
	Функції адміністрування серверної частини програмної системи для контролю успішності учнів художніх шкіл визначаються як комплекс інструментів, що забезпечують підтримку, налаштування та контроль роботи всієї системи. Адміністрування виконує роль організаційного та технічного механізму, який гарантує стабільність функціонування, безпеку даних та відповідність програмного середовища потребам користувачів.
	У межах початкового релізу адміністратор отримує можливість керувати базою даних користувачів, створювати нові облікові записи, редагувати наявні та видаляти неактуальні. Це дозволяє підтримувати актуальність інформації та забезпечувати коректний розподіл ролей між учнями, викладачами та адміністрацією. Адміністративні функції включають також контроль доступу до системи, що реалізується через механізми автентифікації та авторизації. Серверна частина перевіряє права користувачів і визначає рівень доступу до навчальних даних, що гарантує захист інформації та запобігає несанкціонованому використанню.
	Важливим аспектом адміністрування є управління навчальними дисциплінами та навчальними планами. Адміністратор може додавати нові предмети, змінювати їхні параметри та формувати структуру навчального процесу. Це забезпечує гнучкість системи та її адаптацію до потреб конкретного навчального закладу. Окрім цього, адміністратор має можливість здійснювати моніторинг активності користувачів, переглядати журнали подій та аналізувати роботу системи. Такий підхід дозволяє своєчасно виявляти помилки, контролювати навантаження та забезпечувати стабільність функціонування серверної частини.
	Функції адміністрування охоплюють також резервне копіювання та відновлення даних. Серверна частина реалізує механізми створення резервних копій бази даних, що дозволяє захистити інформацію від втрати у випадку технічних збоїв. Адміністратор має можливість відновлювати систему до попереднього стану, забезпечуючи безперервність освітнього процесу.
	Таким чином, функції адміністрування серверної частини програмної системи включають управління користувачами, контроль доступу, налаштування навчальних дисциплін, моніторинг роботи системи та забезпечення збереження даних. Вони формують основу для стабільної та безпечної роботи програмного комплексу, створюючи умови для ефективного використання бізнес-логіки та подальшого розвитку системи.

	Розділ 3. Програмна реалізація бізнес-логіки та функцій адміністрування
	У межах розробки серверної частини інформаційної системи було реалізовано окремий рівень бізнес-логіки, що забезпечує централізовану обробку даних, автоматизацію ключових процесів та відповідність принципам багаторівневої архітектури. Такий підхід дозволяє розділити відповідальність між компонентами: контролери виконують роль інтерфейсу взаємодії з клієнтом, а сервіси — реалізують прикладну логіку, адміністрування та обробку даних.
	У межах реалізації бізнес-логіки було побудовано загальну UML Activity Diagram, яка демонструє послідовність дій користувачів після авторизації в системі. Залежно від ролі (Student, Parent, Teacher, Admin, TechSupport), користувачі виконують відповідні функції: перегляд оцінок, додавання коментарів, керування дисциплінами, моніторинг системи тощо. Усі гілки сходяться до централізованої точки, що відображає єдину серверну логіку та взаємодію з базою даних.


Рисунок 3.1 - Загальна UML Activity Diagram серверної частини ArtProgress

	У межах реалізації бізнес-логіки також було побудовано UML Interaction Diagram, яка демонструє взаємодію між компонентами системи у процесі додавання оцінки викладачем. Діаграма відображає послідовність викликів методів між користувачем, контролером, сервісами, базою даних та механізмом сповіщень, що дозволяє наочно показати логіку обміну повідомленнями у межах одного сценарію.

Рисунок 3.2 - UML Interaction Diagram для сценарію "Додавання оцінки викладачем"

	Діаграма демонструє послідовність викликів методів між учасниками системи у процесі додавання оцінки.
	Основною метою створення бізнес-логіки було забезпечення прозорої та автоматизованої роботи з навчальними даними, зокрема: додавання оцінок, формування коментарів, створення повідомлень для студентів і батьків, а також адміністрування навчальних дисциплін і ролей користувачів. Для цього було реалізовано три окремі сервіси: GradesService, NotificationService та AdminService.
	Сервіс GradesService відповідає за додавання нових оцінок, розрахунок середнього балу студента та формування рейтингу групи. При додаванні оцінки реалізовано автоматичне створення коментаря викладача, що дозволяє зберігати пояснення до оцінки без додаткових дій з боку користувача. Одразу після збереження оцінки викликається механізм сповіщень, який інформує студента та його батьків про новий результат. Така логіка дозволяє забезпечити прозорість навчального процесу та оперативне інформування.

	Виклик механізму сповіщень після додавання оцінки (див. Додаток А, Приклад А1). 
	У цьому фрагменті показано, як після збереження оцінки викликається метод, що відповідає за створення повідомлень.
	Сервіс NotificationService реалізує логіку створення повідомлень для студентів і їхніх батьків. Повідомлення для студента створюється безпосередньо, а для батьків — через проміжну таблицю ParentStudent, яка зберігає зв’язки між студентами та їхніми законними представниками. Такий підхід дозволяє підтримувати ситуації, коли один студент має кількох батьків, і навпаки. Для забезпечення коректної роботи з зовнішніми ключами було внесено зміни до моделі Notification: поля ParentID, StudentID та TeacherID оголошено як nullable (int?). Це дозволяє уникнути помилок при збереженні повідомлень, адресованих лише одній стороні (наприклад, студенту без батьків).
	Створення повідомлення для студента (див. Додаток А, Приклад А2).
	У цьому фрагменті показано, як формується повідомлення для студента. Аналогічно створюються повідомлення для кожного з батьків, ідентифікатори яких отримуються через запит до таблиці ParentStudent.
	Сервіс AdminService реалізує функції адміністрування, зокрема додавання та видалення навчальних дисциплін, зміну ролей користувачів та отримання статистичних даних. Це дозволяє адміністраторам системи контролювати її структуру, наповнення та загальний стан.
	Для інтеграції сервісів у загальну архітектуру було використано механізм залежностей, що дозволяє контролерам напряму викликати методи сервісів без дублювання логіки. Реєстрація сервісів здійснюється у файлі Program.cs через метод AddScoped, а підключення бази даних — через AddDbContext.
	
	Реєстрація сервісів у Program.cs (див. Додаток А, Приклад А3).
	У цьому фрагменті показано, як здійснюється реєстрація бізнес-логіки у контейнері залежностей. Це забезпечує її доступність у контролерах та інших компонентах системи.
	Результатом реалізації стало те, що при додаванні оцінки система автоматично створює коментар, формує повідомлення для студента та його батьків, зберігає всі дані у відповідних таблицях та забезпечує їх доступність через API. Для перевірки роботи сервісів було використано інтерфейс Swagger, де виконано тестові запити до ендпоінтів /api/Notifications/student/{studentId} та /api/Notifications/parent/{parentId}. Отримані відповіді підтвердили коректність реалізації: повідомлення створюються, зберігаються та повертаються у відповідному форматі.
	Після реалізації базових механізмів додавання оцінок та створення повідомлень виникла потреба у впровадженні методів математичної обробки даних, які дозволяють не лише зберігати інформацію, а й отримувати узагальнені показники успішності. Це важливо для адміністрації та викладачів, оскільки дає змогу аналізувати рівень знань студентів, порівнювати результати між групами та формувати рейтинги.
	У межах сервісу GradesService було додано окремі методи для розрахунку середнього балу студента, визначення середніх значень по групі та формування рейтингу. Такі методи реалізують прикладну бізнес-логіку, яка поєднує роботу з базою даних та математичні операції над навчальними результатами.
	Розрахунок середнього балу студента (див. Додаток А, Приклад А4).
	У цьому фрагменті показано, як для конкретного студента обчислюється середній бал на основі його оцінок. Якщо оцінок немає, метод повертає значення 0.0, що дозволяє уникнути помилок при обробці даних. Округлення до двох знаків забезпечує стандартизоване представлення результатів у звітах.
	Середні бали по групі (див. Додаток А, Приклад А5).
	У цьому фрагменті показано, як система обчислює середні бали для кожного студента групи. Результат повертається у вигляді словника, що дозволяє швидко отримати узагальнену картину успішності всієї групи та використовувати ці дані для адміністративного аналізу.
	Формування рейтингу групи (див. Додаток А, Приклад А6).
	У цьому фрагменті показано, як формується рейтинг групи на основі середніх балів студентів. Дані сортуються у порядку спадання, що дозволяє визначити лідерів групи та об’єктивно оцінити рівень успішності.
	Таким чином, сервіс GradesService не лише забезпечує базові CRUD-операції з оцінками, а й реалізує математичні методи обробки даних, які є ключовими для аналітики та управління навчальним процесом. У поєднанні з NotificationService та AdminService формується комплексна бізнес-логіка, що охоплює як збереження навчальної інформації, так і її інтерпретацію для прийняття управлінських рішень. Завдяки такій архітектурі було реалізовано повноцінний рівень бізнес-логіки та адміністрування серверної частини, який забезпечує структуровану взаємодію між компонентами системи, логічну узгодженість, можливість масштабування та прозорість освітнього процесу. Реалізовані сервіси демонструють практичне застосування принципів багаторівневої архітектури та сучасних методів обробки даних, створюючи основу для подальшого розвитку програмного комплексу та впровадження розширених аналітичних можливостей у майбутніх релізах.

	Розділ 4. Перевірка роботи серверної частини системи
	Після реалізації бізнес-логіки та інтеграції сервісів було проведено поетапне тестування серверної частини системи з метою підтвердження її працездатності, узгодженості компонентів та відповідності функціоналу очікуваним вимогам. Перевірка здійснювалася через інтерфейс Swagger UI шляхом виконання HTTP-запитів до відповідних ендпоінтів API.
	Основна увага приділялася перевірці таких аспектів:
	– коректність створення оцінки;
	– автоматичне формування повідомлень для студента та його батьків;
	– правильність роботи зв’язків між сутностями;
	– відсутність помилок зовнішніх ключів;
	– сортування повідомлень за датою;
	– доступність навігаційних властивостей у відповідях API.

	4.1 Додавання нової оцінки
	На першому етапі було перевірено роботу механізму додавання оцінки. Було виконано запит POST /api/Grades, у якому передано ідентифікатори студента, викладача, дисципліни та значення оцінки. У відповіді сервер повернув статус-код 201 Created, що підтверджує успішне створення запису. У тілі відповіді відображено всі передані дані, включно з датою та унікальним ідентифікатором оцінки.








Рисунок 4.1 – Результат запиту на додавання оцінки
	4.2 Перевірка створення повідомлення для студента
	Одразу після додавання оцінки система повинна автоматично створити повідомлення для студента. Для перевірки цього було виконано запит GET /api/Notifications/student/{studentId}. У відповіді API повернуло масив об’єктів типу Notification, серед яких було виявлено повідомлення з текстом, що містить інформацію про щойно додану оцінку. Це підтверджує правильність роботи сервісу сповіщень та коректне збереження зв’язку між оцінкою і студентом.
















Рисунок 4.2 – Повідомлення студента про нову оцінку
	4.3 Перевірка створення повідомлень для батьків
	Система підтримує інформування батьків через таблицю ParentStudent. Було перевірено, чи створюються повідомлення для всіх батьків студента. Для цього виконано запит GET /api/Notifications/parent/{parentId} для кожного з батьків, пов’язаних із цим студентом. У відповіді має бути повідомлення з аналогічним текстом, що підтверджує отримання оцінки дитиною.















Рисунок 4.3 – Повідомлення батька про оцінку дитини

	
	4.4 Перевірка навігаційних властивостей
	Для підтвердження коректності зв’язків між сутностями було виконано запит GET /api/Notifications/all, який повертає всі повідомлення з включеними навігаційними властивостями (Student, Parent, Teacher). Це дозволяє переконатися, що об’єкти повністю підтягуються з бази даних, а модель Notification налаштована правильно.


Рисунок 4.4 – Повна відповідь API з навігаційними властивостями
	
	4.5 Перевірка відсутності помилок зовнішніх ключів
	Особливу увагу було приділено перевірці коректності збереження повідомлень без ParentID, тобто лише для студента. Було підтверджено, що при відсутності батьків у таблиці ParentStudent система не створює помилок, а повідомлення для студента зберігається з ParentID = null













Рисунок 4.5 – Повідомлення без ParentID

	4.6 Перевірка сортування повідомлень за датою
	Було перевірено, що всі повідомлення, які повертаються через API, відсортовані у зворотному хронологічному порядку (від новіших до старіших). Це забезпечує зручність перегляду повідомлень у клієнтській частині та відповідає очікуваній поведінці системи.














Рисунок 4.6 – Сортування повідомлень за датою
	
	Таким чином, проведене тестування підтвердило, що реалізована серверна частина системи функціонує відповідно до поставлених вимог. Усі основні операції виконуються коректно: оцінки успішно додаються до бази даних, повідомлення для студентів та їхніх батьків створюються автоматично, а налаштовані зв’язки між сутностями забезпечують узгодженість та цілісність інформації. Перевірка показала, що дані повертаються у правильному форматі, без помилок зовнішніх ключів, а повідомлення відображаються у зворотному хронологічному порядку, що відповідає очікуваній логіці роботи системи. Усі етапи перевірки виконано успішно, що свідчить про стабільність роботи серверної частини, узгодженість бізнес-логіки та правильність інтеграції сервісів у загальну архітектуру програмного комплексу.

	Висновки 
	У ході виконання лабораторної роботи було реалізовано та перевірено повноцінний рівень бізнес-логіки та функцій адміністрування серверної частини програмної системи для контролю успішності учнів художніх шкіл. Робота мала комплексний характер і охоплювала як інженерні рішення, так і їх практичну перевірку через прикладний програмний інтерфейс.
	По-перше, було створено окремий рівень бізнес-логіки у вигляді сервісів, що дозволило винести складні правила із контролерів та централізувати їх обробку. Такий підхід відповідає принципам багаторівневої архітектури та забезпечує розділення відповідальності між компонентами системи. Контролери виконують роль інтерфейсу взаємодії з клієнтом, а сервіси реалізують прикладну логіку та адміністрування. Це рішення було прийняте для уникнення дублювання коду, підвищення масштабованості та забезпечення узгодженості роботи системи.
	По-друге, було реалізовано три ключові сервіси:
– GradesService, який відповідає за додавання нових оцінок, розрахунок середнього балу студента та формування рейтингу групи. Важливо, що при додаванні оцінки система автоматично створює коментар викладача та викликає механізм сповіщень. Це забезпечує прозорість навчального процесу та дозволяє зберігати пояснення до оцінки без додаткових дій з боку користувача.
– NotificationService, який реалізує логіку створення повідомлень для студентів і їхніх батьків. Для цього використовується проміжна таблиця ParentStudent, що дозволяє підтримувати ситуації з кількома батьками для одного студента. Було внесено зміни до моделі Notification, де зовнішні ключі оголошено як nullable (int?), що забезпечує коректне збереження повідомлень для різних категорій користувачів.
– AdminService, який реалізує функції адміністрування: додавання та видалення дисциплін, зміну ролей користувачів та отримання статистичних даних. Це дозволяє адміністраторам системи контролювати її структуру, наповнення та загальний стан.
	По-третє, було здійснено інтеграцію сервісів у загальну архітектуру через механізм залежностей. У файлі Program.cs зареєстровано контекст бази даних та сервіси, що забезпечило їх доступність у контролерах та інших компонентах системи. Це рішення дозволило уникнути дублювання логіки та забезпечило узгодженість роботи всієї системи.
	По-четверте, було проведено тестування реалізованих функцій через інтерфейс Swagger UI. У ході перевірки підтверджено:
– успішне додавання оцінки (код відповіді 201 Created);
– автоматичне створення повідомлення для студента;
– створення повідомлень для батьків через таблицю ParentStudent;
– коректність навігаційних властивостей у відповіді API;
– відсутність помилок зовнішніх ключів при збереженні повідомлень лише для студента;
– сортування повідомлень за датою у зворотному хронологічному порядку.
	Отримані результати підтвердили правильність реалізації бізнес-логіки, узгодженість роботи сервісів та відповідність функціоналу очікуваним вимогам. Система продемонструвала здатність автоматично обробляти навчальні дані, формувати повідомлення для всіх учасників освітнього процесу та забезпечувати адміністрування навчальних дисциплін і ролей користувачів.
	Таким чином, у результаті виконання роботи було досягнуто таких підсумків:
– реалізовано повноцінний рівень бізнес-логіки та адміністрування серверної частини;
– забезпечено прозорість та автоматизацію навчального процесу;
– підтверджено коректність роботи системи через тестування API;
– створено основу для подальшого розвитку системи, зокрема впровадження розширеної аналітики та інтеграції з зовнішніми освітніми сервісами.
	Виконана робота має практичне значення, оскільки демонструє застосування принципів багаторівневої архітектури, сучасних методів обробки даних та інженерних рішень, спрямованих на забезпечення стабільності, масштабованості та прозорості освітнього процесу.















ДОДАТОК А
А.1 — Виклик механізму сповіщень після додавання оцінки

1 await _notificationService.NotifyOnNewGradeAsync(studentId, teacherId, disciplineId, value);

А.2 — Створення повідомлення для студента

1 _context.Notifications.Add(new Notification
2 {
3     StudentID = studentId,
4     TeacherID = teacherId,
5     Text = $"Нова оцінка: {value} з дисципліни \"{disciplineName}\"",
6     Date = DateTime.UtcNow
7 });

А.3 — Реєстрація сервісів у Program.cs

1 builder.Services.AddScoped<GradesService>();
2 builder.Services.AddScoped<NotificationService>();
3 builder.Services.AddScoped<AdminService>();

А.4 — Розрахунок середнього балу студента

1 public async Task<double> GetStudentAverageAsync(int studentId)
2 {
3     var values = await _context.Grades
4         .Where(g => g.StudentID == studentId)
5         .Select(g => g.Value)
6         .ToListAsync();
7
8     return values.Count == 0 ? 0.0 : Math.Round(values.Average(), 2);
9 }

А.5 — Обчислення середніх балів по групі

1 public async Task<Dictionary<int, double>> GetGroupAveragesAsync(string group)
2 {
3     var students = await _context.Students
4         .Where(s => s.Group == group)
5         .Select(s => new
6         {
7             s.StudentID,
8             Values = s.Grades.Select(g => g.Value)
9         })
10        .ToListAsync();
11
12     var result = new Dictionary<int, double>();
13     foreach (var s in students)
14     {
15         var avg = s.Values.Any() ? Math.Round(s.Values.Average(), 2) : 0.0;
16         result[s.StudentID] = avg;
17     }
18     return result;
19 }

А.6 — Формування рейтингу групи

1 public async Task<List<(int StudentId, double Average)>>
2 GetGroupRankingAsync(string group)
3 {
4     var data = await _context.Students
5         .Where(s => s.Group == group)
6         .Select(s => new
7         {
8             s.StudentID,
9             Avg = s.Grades.Any() ? s.Grades.Average(g => g.Value) : 0.0
10        })
11        .ToListAsync();
12 
13    return data
14        .OrderByDescending(x => x.Avg)
15        .Select(x => (x.StudentID, Math.Round(x.Avg, 2)))
16        .ToList();
17 }




















